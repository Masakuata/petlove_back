openapi: 3.0.0
info:
  title: Sharedz service
  version: 0.4.2
servers:
  - description: Desarrollo HTTPS
    url: 'https://neutral-kindly-wildcat.ngrok-free.app'
  - description: Desarrollo HTTP
    url: 'http://clayrite.ddns.net:81'
components:
  schemas:
    token:
      type: string
      title: Token identificador de la sesion de usuario
      example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
    email:
      type: string
      title: Email del usuario
      minLength: 5
      maxLength: 320
      example: correo@dominio.com
    username:
      type: string
      title: Username del usuario
      example: juanito
    password:
      type: string
      title: Contrasena del usuario
      example: password981
    newUsuario:
      type: object
      title: Usuario para registrar
      description: Informacion del usuario a registrar
      required:
        - username
        - email
        - password
      properties:
        username:
          allOf:
            - type: string
              title: Username del usuario
              example: juanito
        email:
          allOf:
            - type: string
              title: Email del usuario
              minLength: 5
              maxLength: 320
              example: correo@dominio.com
        password:
          allOf:
            - type: string
              title: Contrasena del usuario
              example: password981
    publicUsuario:
      type: object
      title: Informacion publica de usuario
      description: Informacion publica de un usuario registrado
      required:
        - username
        - email
      properties:
        username:
          allOf:
            - type: string
              title: Username del usuario
              example: juanito
        email:
          allOf:
            - type: string
              title: Email del usuario
              minLength: 5
              maxLength: 320
              example: correo@dominio.com
        token:
          allOf:
            - type: string
              title: Token identificador de la sesion de usuario
              example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
    loginCredentials:
      type: object
      title: Credenciales de inicio de sesion
      description: Correo electronico y contrasena de un usuario registrado
      required:
        - email
        - password
      properties:
        email:
          allOf:
            - type: string
              title: Email del usuario
              minLength: 5
              maxLength: 320
              example: correo@dominio.com
        password:
          allOf:
            - type: string
              title: Contrasena del usuario
              example: password981
  parameters:
    header_token:
      name: Token
      description: Token identificador de la sesion de usuario
      in: header
      schema:
        type: string
        title: Token identificador de la sesion de usuario
        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
      required: true
    path_username:
      name: username
      description: Username del usuario
      in: path
      schema:
        type: string
        title: Username del usuario
        example: juanito
      required: true
  headers:
    Token:
      schema:
        type: string
        title: Token identificador de la sesion de usuario
        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
  responses:
    '400':
      description: La solicitud esta incompleta o malformada
    '404':
      description: El recurso buscado no se encuentra registrado
    '406':
      description: La solicitud o su contenido no es aceptable y no puede ser procesada
    '500':
      description: Error interno del servidor
    response_token:
      description: Token identificador de la sesion de usuario
      headers:
        Token:
          schema:
            type: string
            title: Token identificador de la sesion de usuario
            example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
    response_publicUsuario:
      description: .
      content:
        application/json:
          schema:
            type: object
            title: Informacion publica de usuario
            description: Informacion publica de un usuario registrado
            required:
              - username
              - email
            properties:
              username:
                allOf:
                  - type: string
                    title: Username del usuario
                    example: juanito
              email:
                allOf:
                  - type: string
                    title: Email del usuario
                    minLength: 5
                    maxLength: 320
                    example: correo@dominio.com
              token:
                allOf:
                  - type: string
                    title: Token identificador de la sesion de usuario
                    example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
paths:
  /usuario:
    summary: Catalogo de usuarios
    description: Endpoint para realizar diversas operaciones respecto al catalogo de usuarios del sistema
    get:
      summary: Obten los usuarios registrados
      description: Devuelve todos los usuarios registrados
      tags:
        - Usuario
      parameters:
        - name: Token
          description: Token identificador de la sesion de usuario
          in: header
          schema:
            type: string
            title: Token identificador de la sesion de usuario
            example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
          required: true
      responses:
        '200':
          description: Se ha retornado por lo menos un usuario registrado
          content:
            application/json:
              schema:
                type: array
                items:
                  anyOf:
                    - type: object
                      title: Informacion publica de usuario
                      description: Informacion publica de un usuario registrado
                      required:
                        - username
                        - email
                      properties:
                        username:
                          allOf:
                            - type: string
                              title: Username del usuario
                              example: juanito
                        email:
                          allOf:
                            - type: string
                              title: Email del usuario
                              minLength: 5
                              maxLength: 320
                              example: correo@dominio.com
                        token:
                          allOf:
                            - type: string
                              title: Token identificador de la sesion de usuario
                              example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
                    - type: object
                      title: Informacion publica de usuario
                      description: Informacion publica de un usuario registrado
                      required:
                        - username
                        - email
                      properties:
                        username:
                          allOf:
                            - type: string
                              title: Username del usuario
                              example: juanito
                        email:
                          allOf:
                            - type: string
                              title: Email del usuario
                              minLength: 5
                              maxLength: 320
                              example: correo@dominio.com
                        token:
                          allOf:
                            - type: string
                              title: Token identificador de la sesion de usuario
                              example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
                    - type: object
                      title: Informacion publica de usuario
                      description: Informacion publica de un usuario registrado
                      required:
                        - username
                        - email
                      properties:
                        username:
                          allOf:
                            - type: string
                              title: Username del usuario
                              example: juanito
                        email:
                          allOf:
                            - type: string
                              title: Email del usuario
                              minLength: 5
                              maxLength: 320
                              example: correo@dominio.com
                        token:
                          allOf:
                            - type: string
                              title: Token identificador de la sesion de usuario
                              example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
        '204':
          description: No hay ningun usuario registrado
        '500':
          description: Error interno del servidor
    post:
      summary: Crea un nuevo usuario en el sistema
      description: Crea un nuevo usuario en el sistema con la informacion provista
      tags:
        - Usuario
      requestBody:
        description: Informacion necesaria para registrar un nuevo usuario
        content:
          application/json:
            schema:
              type: object
              title: Usuario para registrar
              description: Informacion del usuario a registrar
              required:
                - username
                - email
                - password
              properties:
                username:
                  allOf:
                    - type: string
                      title: Username del usuario
                      example: juanito
                email:
                  allOf:
                    - type: string
                      title: Email del usuario
                      minLength: 5
                      maxLength: 320
                      example: correo@dominio.com
                password:
                  allOf:
                    - type: string
                      title: Contrasena del usuario
                      example: password981
      responses:
        '201':
          description: La solicitud fue exitosa y el nuevo usuario ha sido creado
          content:
            application/json:
              schema:
                type: object
                title: Informacion publica de usuario
                description: Informacion publica de un usuario registrado
                required:
                  - username
                  - email
                properties:
                  username:
                    allOf:
                      - type: string
                        title: Username del usuario
                        example: juanito
                  email:
                    allOf:
                      - type: string
                        title: Email del usuario
                        minLength: 5
                        maxLength: 320
                        example: correo@dominio.com
                  token:
                    allOf:
                      - type: string
                        title: Token identificador de la sesion de usuario
                        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
          headers:
            Token:
              schema:
                type: string
                title: Token identificador de la sesion de usuario
                example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
        '400':
          description: La solicitud esta incompleta o malformada
        '406':
          description: La solicitud o su contenido no es aceptable y no puede ser procesada
        '409':
          description: El username o correo ya han sido registrados
        '500':
          description: Error interno del servidor
    delete:
      summary: Elimina un usuario registrado
      description: Elimina de forma permanente la informacion de usuario identificado por sus credenciales
      tags:
        - Usuario
      parameters:
        - name: Token
          description: Token identificador de la sesion de usuario
          in: header
          schema:
            type: string
            title: Token identificador de la sesion de usuario
            example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
          required: true
      responses:
        '200':
          description: La informacion del usuario ha sido eliminada.
        '400':
          description: La solicitud esta incompleta o malformada
        '404':
          description: No se ha encontrado ningun usuario con esas credenciales
        '406':
          description: El token provisto no coincide con las credenciales indicadas o ha expirado
        '500':
          description: Error interno del servidor
  /usuario/login:
    summary: Inica sesion con un usuario registrado
    description: Obten un nuevo token con las credenciales de un usuario registrado
    post:
      summary: Inica sesion con un usuario registrado
      description: Obten un nuevo token con las credenciales de un usuario registrado
      tags:
        - Usuario
        - Sesion
      requestBody:
        content:
          application/json:
            schema:
              type: object
              title: Credenciales de inicio de sesion
              description: Correo electronico y contrasena de un usuario registrado
              required:
                - email
                - password
              properties:
                email:
                  allOf:
                    - type: string
                      title: Email del usuario
                      minLength: 5
                      maxLength: 320
                      example: correo@dominio.com
                password:
                  allOf:
                    - type: string
                      title: Contrasena del usuario
                      example: password981
      responses:
        '200':
          description: Credenciales correctas y sesion iniciada
          content:
            application/json:
              schema:
                type: object
                title: Informacion publica de usuario
                description: Informacion publica de un usuario registrado
                required:
                  - username
                  - email
                properties:
                  username:
                    allOf:
                      - type: string
                        title: Username del usuario
                        example: juanito
                  email:
                    allOf:
                      - type: string
                        title: Email del usuario
                        minLength: 5
                        maxLength: 320
                        example: correo@dominio.com
                  token:
                    allOf:
                      - type: string
                        title: Token identificador de la sesion de usuario
                        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
        '400':
          description: La solicitud esta incompleta o malformada
        '404':
          description: Las credenciales no coinciden con ningun usuario registrado
        '406':
          description: La solicitud o su contenido no es aceptable y no puede ser procesada
        '500':
          description: Error interno del servidor
  /usuario/token:
    get:
      summary: Obten la informacion de un usuario a partir de su token
      description: Comprueba la validez de un token y retorna la informacion asociada al token
      tags:
        - Usuario
        - Sesion
      parameters:
        - name: Token
          description: Token identificador de la sesion de usuario
          in: header
          schema:
            type: string
            title: Token identificador de la sesion de usuario
            example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
          required: true
      responses:
        '200':
          description: El token es valido
          content:
            application/json:
              schema:
                type: object
                title: Informacion publica de usuario
                description: Informacion publica de un usuario registrado
                required:
                  - username
                  - email
                properties:
                  username:
                    allOf:
                      - type: string
                        title: Username del usuario
                        example: juanito
                  email:
                    allOf:
                      - type: string
                        title: Email del usuario
                        minLength: 5
                        maxLength: 320
                        example: correo@dominio.com
                  token:
                    allOf:
                      - type: string
                        title: Token identificador de la sesion de usuario
                        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
        '400':
          description: La solicitud esta incompleta o malformada
        '404':
          description: No existen registros de un usuario asociado al token
        '406':
          description: El token es invalido o ya ha expirado
        '500':
          description: Error interno del servidor
  '/usuario/{username}/username':
    summary: Cambia el username de un usuario
    description: Actualiza el username de un usuario identificado por su username actual
    put:
      summary: Cambia el username de un usuario
      description: Actualiza el username de un usuario identificado por su username actual
      tags:
        - Actualizar usuario
      parameters:
        - name: Token
          description: Token identificador de la sesion de usuario
          in: header
          schema:
            type: string
            title: Token identificador de la sesion de usuario
            example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
          required: true
        - name: username
          description: Username del usuario
          in: path
          schema:
            type: string
            title: Username del usuario
            example: juanito
          required: true
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - username
              properties:
                username:
                  type: string
                  title: Username del usuario
                  example: juanito
      responses:
        '200':
          description: Se ha actualizado el username del usuario
          content:
            application/json:
              schema:
                type: object
                title: Informacion publica de usuario
                description: Informacion publica de un usuario registrado
                required:
                  - username
                  - email
                properties:
                  username:
                    allOf:
                      - type: string
                        title: Username del usuario
                        example: juanito
                  email:
                    allOf:
                      - type: string
                        title: Email del usuario
                        minLength: 5
                        maxLength: 320
                        example: correo@dominio.com
                  token:
                    allOf:
                      - type: string
                        title: Token identificador de la sesion de usuario
                        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
        '400':
          description: La solicitud esta incompleta o malformada
        '404':
          description: Las credenciales no coinciden con ningun usuario registrado
        '406':
          description: La solicitud o su contenido no es aceptable y no puede ser procesada
        '409':
          description: El nuevo username ya se encuentra en uso por otro usuario
        '500':
          description: Error interno del servidor
  '/usuario/{username}/email':
    summary: Cambia el email de un usuario
    description: Actualiza el email de un usuario identificado por su username
    put:
      summary: Cambia el email de un usuario
      description: Actualiza el email de un usuario identificado por su username
      tags:
        - Actualizar usuario
      parameters:
        - name: username
          description: Username del usuario
          in: path
          schema:
            type: string
            title: Username del usuario
            example: juanito
          required: true
        - name: Token
          description: Token identificador de la sesion de usuario
          in: header
          schema:
            type: string
            title: Token identificador de la sesion de usuario
            example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
          required: true
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  title: Email del usuario
                  minLength: 5
                  maxLength: 320
                  example: correo@dominio.com
      responses:
        '200':
          description: Se ha actualizado el email del usuario
          content:
            application/json:
              schema:
                type: object
                title: Informacion publica de usuario
                description: Informacion publica de un usuario registrado
                required:
                  - username
                  - email
                properties:
                  username:
                    allOf:
                      - type: string
                        title: Username del usuario
                        example: juanito
                  email:
                    allOf:
                      - type: string
                        title: Email del usuario
                        minLength: 5
                        maxLength: 320
                        example: correo@dominio.com
                  token:
                    allOf:
                      - type: string
                        title: Token identificador de la sesion de usuario
                        example: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkY29ycmVvMkBjb3JyZW8uY29tIiwiZXhwIjoxNzA0OTYwNjUzLCJ1c2VybmFtZ
        '400':
          description: La solicitud esta incompleta o malformada
        '404':
          description: Las credenciales no coinciden con ningun usuario registrado
        '406':
          description: La solicitud o su contenido no es aceptable y no puede ser procesada
        '409':
          description: El nuevo email ya se encuentra en uso por otro usuario
        '500':
          description: Error interno del servidor
